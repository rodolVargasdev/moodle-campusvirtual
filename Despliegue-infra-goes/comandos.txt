#nos aseguramos que exista el NS moodle
kubectl create ns moodle

#crear la IP estatica global
gcloud compute addresses create moodle-ip --global

#hay que crear el secreto con los archivos del cert y key para usar https:
kubectl create secret tls cloudflare-cert --cert=cert.pem --key=key.pem -n moodle

#en el mismo folder que estan los files se puede correr este comando para crearlos todos
kubectl apply -f .

#comandos utiles para verificar el estado:
kubectl get pods -n moodle
kubectl get svc -n moodle
kubectl get ingress -n moodle
kubectl describe ingress moodle-service -n moodle

#verificar que la IP estatica fue creada:
gcloud compute addresses list

#verificar logs del pod si hay problemas:
kubectl logs -n moodle deployment/moodle-complete --tail=50

#si necesitas eliminar todo y empezar de nuevo:
# kubectl delete -f .
# gcloud compute addresses delete moodle-ip --global